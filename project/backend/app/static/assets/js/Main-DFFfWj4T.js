const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/AnalysisHistory-Dxkyame6.js","assets/js/Logo-B_L5yj1R.js","assets/js/index-Bs4Z5MWp.js","assets/css/index-D3nDvg0c.css","assets/css/Logo-LlBiUJ3O.css","assets/js/index-BtuGy7By.js","assets/css/AnalysisHistory-DOlJh9Ke.css","assets/js/TechnicalEvaluation-odg4Y9Li.js","assets/css/TechnicalEvaluation-CC8ORzy9.css","assets/js/Analysis-DvuXCKfv.js","assets/css/Analysis-DCRmQWSB.css"])))=>i.map(i=>d[i]);
import{k as L,u as C,e as w,l as M,m as O,c,b as v,a as e,i as I,T as S,p as k,j as y,F as U,r as V,f as m,t as u,q as F,s as x,n as E,o as r,w as Q,x as z,y as G,z as _,A as B,B as J,_ as T}from"./index-Bs4Z5MWp.js";import{_ as P,l as H}from"./Logo-B_L5yj1R.js";import{a as R}from"./index-BtuGy7By.js";const Y=L("history",()=>{const l=C(),s=w([]),i=w(null),n=w(!1),o=w(null);return{historyItems:s,currentAnalysisId:i,isLoading:n,error:o,setCurrentAnalysisId:t=>{i.value=t},fetchHistory:async()=>{try{n.value=!0;const t=await fetch("/api/history",{headers:{Authorization:`Bearer ${l.token}`}});if(!t.ok){const{message:p}=await t.json();o.value=p||"获取历史记录失败";return}const{data:d}=await t.json();s.value=d,s.value.length>0&&(i.value=s.value[0].id),o.value=null}catch(t){o.value=t.message||"请求失败，请检查网络连接",console.error("获取历史记录失败:",t)}finally{n.value=!1}},deleteItem:async t=>{try{const d=Number(t),p=await fetch(`/api/history/${d}`,{method:"DELETE",headers:{Authorization:`Bearer ${l.token}`}});if(!p.ok){let h="删除项目失败";try{h=(await p.json()).message||h}catch{h=`${p.status} ${p.statusText}`}o.value=h;return}s.value=s.value.filter(h=>h.id!==d),i.value===d&&(i.value=null),o.value=null}catch(d){o.value=d.message||"删除请求失败，请检查网络连接",console.error("删除操作失败:",d)}}}}),j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA+0lEQVR42u3XPQrCMBiAYbtYf65QOqlFcXLwEko9h2dxcbC9gGBBT+EdBAdtpeAdFBw+3yFTB3+wJiIJPFDokJcmtE3Fjp8c9dbIhQe/JB5qr04eYIkT8pKckKD3bPIqlpAvSVB9FOAhhWCHCDEW2EKULRaIXxBhB0EK71GAjxyCuHBvClGmb+6pGIIcvg34rwCuHbTQhmMiYIA9UoQmAsa4QHBGqDuggTluhQg9AepeExFEOaKjO2AOUVIEOpdgVliCic49EOJanFxnwBAHZJiYehF1EMCx3wIb8GGA+V8yFyvIl6zhPntcXSTIkJckwwZ9owcTe+T7yXEHdqT/B3xAAB8AAAAASUVORK5CYII=",q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA/klEQVR42u3XsQqCQByA8aYssrEmcQqiaOo1gmrsFXqSIAgayhcIkuopeoKW1gqhraXWGv59w003WIGeEnfwA/GG+1BRr2BHLke50XPgwU+Ih9K3izexwgVRQi4I0f60eBErSEpCFOMCPJwgOGKJAAvsIcoeCwRfWOIIwQleXICPCIJAmxtDlPGPz1QAQQTfBvxvAOfL6KJmPIBzLia4YwPXWIBafIoXBAfUjARwXNEWv2Kgpo0EjPCE4IahmsosYGA6wMVcuwV9QwF6hPmHUI+Y4YEdqlm+iOr2W2AD4gJy/UvmYA1JyRbOp8vVQogzooScsUMn042J3fLlcrwBYJz+9JWY1lwAAAAASUVORK5CYII=",D="/assets/png/default-avatar-DbLJzQkT.png",K={components:{logo:H},props:{activeTab:{type:String,required:!0},isCollapsed:{type:Boolean,default:!1}},data(){return{showUploadDialog:!1,selectedFile:null,uploadProgress:0,uploadStatus:null,tabs:[{id:"analysis-view",label:"分析界面"},{id:"analysis-history",label:"分析历史"},{id:"technical-evaluation",label:"技术问答"}]}},methods:{goHome(){this.$router.push("/")},triggerFileInput(){this.$refs.fileInput.click()},handleFileSelect(l){const s=l.target.files[0];if(!s)return;if(!["video/mp4","video/quicktime","video/x-msvideo"].includes(s.type)){alert("仅支持 MP4、MOV 和 AVI 格式的视频");return}if(s.size>1024*1024*1024){alert("文件大小不能超过1G");return}this.selectedFile=s,this.showUploadDialog=!0,this.uploadStatus=null,this.uploadProgress=0},performUpload(){const l=new FormData;l.append("video",this.selectedFile);const s={headers:{Authorization:`Bearer ${this.authStore.token}`}};this.uploadStatus="uploading",R.post("/api/upload",l,s).then(i=>{this.uploadStatus="success",this.historyStore.fetchHistory(),setTimeout(()=>{this.closeUploadDialog(),this.$emit("video-uploaded",i.data)},1500)}).catch(i=>{this.uploadStatus="error",console.error("上传失败:",i)})},closeUploadDialog(){this.showUploadDialog=!1,this.selectedFile=null,this.uploadProgress=0,this.uploadStatus=null},handleTabClick(l){l.id==="analysis-view"&&!this.hasHistory||this.$emit("switch-tab",l.id)}},setup(){const l=C(),s=Y();M(()=>{l.isLoggedIn&&!l.userInfo&&l.fetchUserInfo()});const i=O(()=>{var n;return((n=s.historyItems)==null?void 0:n.length)>0});return{authStore:l,historyStore:s,hasHistory:i}}},W={class:"logo"},X={class:"sidebar-header"},N={class:"control-buttons"},Z={class:"sidebar-nav"},$=["onClick"],ee={key:0,class:"upload-modal"},se={class:"modal-content"},te={class:"file-info"},oe={key:0,class:"progress-bar"},le={class:"progress-text"},ae={key:1,class:"status-success"},ie={key:2,class:"status-error"},ne={class:"modal-actions"},re=["disabled"],de={class:"username"};function ue(l,s,i,n,o,a){var A;const g=y("logo");return r(),c(U,null,[v(S,{name:"button-fade"},{default:I(()=>[i.isCollapsed?(r(),c("button",{key:0,class:"expand-btn",onClick:s[0]||(s[0]=t=>l.$emit("toggle-collapse"))},s[8]||(s[8]=[e("img",{src:j,alt:"打开侧栏"},null,-1)]))):m("",!0)]),_:1}),e("nav",{class:E(["user-sidebar",{collapsed:i.isCollapsed}])},[e("h3",W,[v(g)]),e("button",{class:"collapse-btn",onClick:s[1]||(s[1]=t=>l.$emit("toggle-collapse"))},s[9]||(s[9]=[e("img",{src:q,alt:"收起侧栏"},null,-1)])),e("div",X,[e("div",N,[e("input",{type:"file",ref:"fileInput",hidden:"",accept:"video/mp4,video/quicktime,video/x-msvideo",onChange:s[2]||(s[2]=(...t)=>a.handleFileSelect&&a.handleFileSelect(...t))},null,544),e("button",{class:"nav-item",onClick:s[3]||(s[3]=(...t)=>a.triggerFileInput&&a.triggerFileInput(...t))},s[10]||(s[10]=[e("span",null,"上传视频",-1)])),e("button",{class:"nav-item",onClick:s[4]||(s[4]=(...t)=>a.goHome&&a.goHome(...t))},s[11]||(s[11]=[e("span",null,"返回首页",-1)]))]),s[12]||(s[12]=e("hr",null,null,-1))]),e("ul",Z,[(r(!0),c(U,null,V(o.tabs,t=>(r(),c("li",{key:t.id,class:E(["nav-item",{active:i.activeTab===t.id,disabled:t.id==="analysis-view"&&!n.hasHistory}]),onClick:d=>a.handleTabClick(t)},[e("span",null,u(t.label),1)],10,$))),128))]),(r(),k(x,{to:"body"},[o.showUploadDialog?(r(),c("div",ee,[e("div",se,[s[13]||(s[13]=e("h3",null,"确认上传视频",-1)),e("div",te,[e("p",null,"文件名: "+u(o.selectedFile.name),1),e("p",null,"文件类型: "+u(o.selectedFile.type),1),e("p",null,"文件大小: "+u((o.selectedFile.size/1024/1024).toFixed(2))+"MB",1)]),o.uploadStatus==="uploading"?(r(),c("div",oe,[e("div",{class:"progress-fill",style:F({width:o.uploadProgress+"%"})},null,4),e("span",le,u(o.uploadProgress)+"%",1)])):m("",!0),o.uploadStatus==="success"?(r(),c("div",ae," 上传成功 ")):m("",!0),o.uploadStatus==="error"?(r(),c("div",ie," 上传失败，请重试 ")):m("",!0),e("div",ne,[o.uploadStatus?m("",!0):(r(),c("button",{key:0,class:"confirm-btn",onClick:s[5]||(s[5]=(...t)=>a.performUpload&&a.performUpload(...t))}," 确认上传 ")),e("button",{class:"cancel-btn",onClick:s[6]||(s[6]=(...t)=>a.closeUploadDialog&&a.closeUploadDialog(...t)),disabled:o.uploadStatus==="uploading"},u(o.uploadStatus==="uploading"?"上传中...":"取消"),9,re)])])])):m("",!0)])),e("div",{class:"user-entry",onClick:s[7]||(s[7]=t=>l.$emit("toggle-user-panel"))},[s[14]||(s[14]=e("div",{class:"user-avatar"},[e("img",{src:D,alt:"用户"})],-1)),e("span",de,u(((A=n.authStore.userInfo)==null?void 0:A.username)??"加载中..."),1)])],2)],64)}const ce=P(K,[["render",ue],["__scopeId","data-v-53014787"]]),pe={props:{show:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>({name:"未命名",days:10,mobile:"未绑定",wechatBound:!1})}},emits:["close"],methods:{handleClose(){this.$emit("close")},handleBind(l){console.log(`绑定${l}`)},async handleLogout(){confirm("确定要退出登录吗？退出后将清除本机登录记录")&&(await this.$router.push("/login"),this.authStore.logout(),this.handleClose())}},setup(){return{authStore:C()}}},he={key:0,class:"user-panel-wrapper"},Ae={class:"user-panel"},ge={class:"user-header"},me={class:"user-meta"},ve={class:"settings-container"},fe={class:"settings-group"},be={class:"setting-item"},we={class:"action"},ye={class:"status"},Ce={class:"setting-item"},Ie={class:"action"},Se={class:"status"},ke={class:"action-buttons"};function _e(l,s,i,n,o,a){return r(),k(x,{to:"body"},[v(S,{name:"panel-slide"},{default:I(()=>{var g,A,t,d,p,h,b;return[i.show?(r(),c("div",he,[e("div",Ae,[e("div",{class:"panel-close",onClick:s[0]||(s[0]=(...f)=>a.handleClose&&a.handleClose(...f))},s[4]||(s[4]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])),e("div",ge,[s[5]||(s[5]=e("div",{class:"avatar"},[e("img",{src:D,alt:"avatar"})],-1)),e("div",me,[e("h3",null,u(((g=n.authStore.userInfo)==null?void 0:g.username)??"加载中..."),1),e("p",null,"与 Paddle PingPong 共度 "+u(((A=n.authStore.userInfo)==null?void 0:A.days)??"n")+" 天",1)])]),e("div",ve,[e("section",fe,[s[8]||(s[8]=e("h4",{class:"group-title"},"账号设置",-1)),e("div",be,[s[6]||(s[6]=e("span",null,"手机号",-1)),e("div",we,[e("span",ye,u((t=n.authStore.userInfo)!=null&&t.phone?(d=n.authStore.userInfo)==null?void 0:d.phone:"未绑定"),1),e("button",{class:"bind-btn",onClick:s[1]||(s[1]=f=>a.handleBind("mobile"))},"绑定")])]),e("div",Ce,[s[7]||(s[7]=e("span",null,"微信账号",-1)),e("div",Ie,[e("span",Se,u((p=n.authStore.userInfo)!=null&&p.weixin?(h=n.authStore.userInfo)==null?void 0:h.weixin:"未绑定"),1),e("button",{class:"bind-btn",onClick:s[2]||(s[2]=f=>a.handleBind("wechat"))},u((b=n.authStore.userInfo)!=null&&b.weixin?"解绑":"绑定"),1)])])]),s[10]||(s[10]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"帮助与反馈"),e("div",{class:"setting-item link-item"},[e("span",null,"使用帮助"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"意见反馈"),e("span",{class:"arrow"},"›")])],-1)),s[11]||(s[11]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"关于 Paddle PingPong"),e("div",{class:"setting-item link-item"},[e("span",null,"服务协议"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"隐私协议"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"开源条款"),e("span",{class:"arrow"},"›")])],-1)),s[12]||(s[12]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"百度飞浆大模型版本"),e("div",{class:"setting-item"},[e("span",null,"当前版本"),e("span",{class:"version"},"V0.1.4")]),e("div",{class:"setting-item link-item"},[e("span",null,"模型介绍"),e("span",{class:"arrow"},"›")])],-1)),e("div",ke,[e("button",{class:"logout-btn",onClick:s[3]||(s[3]=(...f)=>a.handleLogout&&a.handleLogout(...f))},"退出登录"),s[9]||(s[9]=e("button",{class:"delete-account"},"注销账号",-1))])])])])):m("",!0)]}),_:1})])}const Be=P(pe,[["render",_e],["__scopeId","data-v-02188b7b"]]),Te=_(B(()=>T(()=>import("./AnalysisHistory-Dxkyame6.js"),__vite__mapDeps([0,1,2,3,4,5,6])))),Pe=_(B(()=>T(()=>import("./TechnicalEvaluation-odg4Y9Li.js"),__vite__mapDeps([7,2,3,1,4,8])))),Ue=_(B({loader:()=>T(()=>import("./Analysis-DvuXCKfv.js"),__vite__mapDeps([9,2,3,1,4,5,10])),delay:200})),Ee={components:{SidebarNav:ce,UserPanel:Be},data(){return{isMobile:!1,activeTab:"analysis-history",showUserPanel:!1,isSidebarCollapsed:!1,componentsMap:G({"analysis-history":Te,"technical-evaluation":Pe,"analysis-view":Ue})}},computed:{activeComponent(){return this.componentsMap[this.activeTab]},sidebarWidth(){return this.isMobile?"0":this.isSidebarCollapsed?"20px":"240px"}},mounted(){this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeUnmount(){window.removeEventListener("resize",this.checkIsMobile)},methods:{switchTab(l){this.activeTab=l},switchToAnalysisView(){this.activeTab="analysis-view"},toggleUserPanel(){this.showUserPanel=!this.showUserPanel},handleLogout(){localStorage.removeItem("mockAuth"),localStorage.removeItem("mockUser"),this.$router.push("/login")},checkIsMobile(){this.isMobile=window.innerWidth<=768,this.isMobile&&!this.isSidebarCollapsed&&(this.isSidebarCollapsed=!0)}}},Fe={class:"user-container"};function xe(l,s,i,n,o,a){const g=y("SidebarNav"),A=y("UserPanel");return r(),c("div",Fe,[v(g,{"active-tab":o.activeTab,"is-collapsed":o.isSidebarCollapsed,onSwitchTab:a.switchTab,onToggleUserPanel:a.toggleUserPanel,onToggleCollapse:s[0]||(s[0]=t=>o.isSidebarCollapsed=!o.isSidebarCollapsed)},null,8,["active-tab","is-collapsed","onSwitchTab","onToggleUserPanel"]),e("main",{class:"user-main",style:F({marginLeft:a.sidebarWidth})},[v(S,{name:"fade-slide",mode:"out-in"},{default:I(()=>[(r(),k(J(a.activeComponent),{onCheck:a.switchToAnalysisView},null,40,["onCheck"]))]),_:1}),v(A,{show:o.showUserPanel,"user-info":l.currentUser,onClose:a.toggleUserPanel,onLogout:a.handleLogout},null,8,["show","user-info","onClose","onLogout"])],4),Q(e("div",{class:"sidebar-mask",onClick:s[1]||(s[1]=t=>o.isSidebarCollapsed=!0)},null,512),[[z,o.isMobile&&!o.isSidebarCollapsed]])])}const De=P(Ee,[["render",xe],["__scopeId","data-v-6c4d8313"]]),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:De},Symbol.toStringTag,{value:"Module"}));export{Ve as M,Y as u};
